<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLIMAX | Elite Men's Bracelets</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>

    <style>
        :root { --gold: #D4AF37; --black: #080808; }
        body { background-color: var(--black); color: white; font-family: 'Montserrat', sans-serif; scroll-behavior: smooth; }
        .luxury-font { font-family: 'Cinzel', serif; }
        .gold-text { color: var(--gold); }
        .gold-bg { background-color: var(--gold); }
        .product-card { background: #111; border: 1px solid #1a1a1a; transition: 0.3s ease; cursor: pointer; }
        .product-card:hover { border-color: var(--gold); transform: translateY(-5px); }
        #cartSidebar { transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .cart-open { transform: translateX(0) !important; }
        .hidden { display: none; }
        input, textarea, select { border-radius: 4px !important; background-color: #000 !important; border: 1px solid #27272a !important; color: #fff !important; }
        input:focus, textarea:focus { border-color: var(--gold) !important; outline: none; }

        /* Review slider & banner styles omitted for brevity (keep your original CSS) */
    </style>
</head>
<body class="overflow-x-hidden">

    <!-- Your navbar, banners, header, products, reviews, footer, etc. remain unchanged -->

    <script>
        const COD_FEE = 50;
        const MY_UPI_ID = '8850484512@fam';

        const firebaseConfig = {
            apiKey: "AIzaSyD4B88SlR4aXarruyfenpQG2_ttw1ZjuHQ",
            authDomain: "climax-fbf10.firebaseapp.com",
            projectId: "climax-fbf10",
            storageBucket: "climax-fbf10.firebasestorage.app",
            messagingSenderId: "273590231780",
            appId: "1:273590231780:web:87ddd68084e4db648c42f1",
            databaseURL: "https://climax-fbf10-default-rtdb.firebaseio.com"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        const products = [
            { id: 1, name: 'Midnight Onyx leather', price: 549, img: 'https://u.cubeupload.com/qazwsxedcrf/388WhatsAppImage2025123.jpeg', desc: 'Crafted from matte-finish natural Onyx Leather, this piece embodies strength and silence. Perfect for the modern professional.' },
            { id: 2, name: 'Volcanic Raw Leather', price: 249, img: 'https://u.cubeupload.com/qazwsxedcrf/388WhatsAppImage2025123.jpeg', desc: 'Sourced from real volcanic Leather, the porous texture adds a rugged, earthy character to your wrist. Essential for casual styling.' },
            { id: 3, name: 'Imperial Leather', price: 249, img: 'https://u.cubeupload.com/qazwsxedcrf/f26WhatsAppImage2025123.jpeg', desc: 'Known as the Leather of courage, our features a deep golden chatoyancy that shifts beautifully under light.' },
            { id: 4, name: 'Classic Leather', price: 249, img: 'https://u.cubeupload.com/qazwsxedcrf/8b1WhatsAppImage2025123.jpeg', desc: 'Triple-braided Italian leather with a 316L surgical steel lock system. A premium accessory for any oversize t-shirt or shirt.' }
        ];

        let cart = [];
        let curID = null;

        // Render Homepage
        const grid = document.getElementById('productGrid');
        products.forEach(p => {
            grid.innerHTML += `
                <div class="product-card p-4 flex flex-col" onclick="openProductPage(${p.id})">
                    <img src="${p.img}" class="w-full aspect-square object-cover mb-4 rounded shadow-lg">
                    <h3 class="font-semibold tracking-widest uppercase text-xs">${p.name}</h3>
                    <p class="gold-text font-bold mb-4">₹${p.price}</p>
                    <button class="mt-auto w-full py-3 border border-zinc-800 text-[9px] tracking-widest hover:bg-white hover:text-black transition uppercase">View Product</button>
                </div>`;
        });

        function toggleCart() { document.getElementById('cartSidebar').classList.toggle('cart-open'); }
        function openProductPage(id) {
            const p = products.find(x => x.id === id); curID = id;
            document.getElementById('pName').innerText = p.name;
            document.getElementById('pPrice').innerText = '₹' + p.price;
            document.getElementById('pDesc').innerText = p.desc;
            document.getElementById('mainImg').src = p.img;
            document.getElementById('productPage').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }
        function closeProductPage() { document.getElementById('productPage').classList.add('hidden'); document.body.style.overflow = 'auto'; }
        function addCurrentToCart() { addToCart(curID); closeProductPage(); }
        function addToCart(id) { cart.push(products.find(x => x.id === id)); updateCartUI(); toggleCart(); }
        function updateCartUI() {
            document.getElementById('cartCount').innerText = cart.length;
            const t = cart.reduce((s, i) => s + i.price, 0);
            document.getElementById('cartTotal').innerText = `₹${t}`;
            document.getElementById('cartItems').innerHTML = cart.map((i, idx) => `
                <div class="flex items-center gap-4 bg-zinc-900/40 p-3 border border-zinc-900 rounded">
                    <img src="${i.img}" class="w-12 h-12 object-cover rounded">
                    <div class="flex-1 text-[10px] uppercase font-bold tracking-widest">${i.name}<br><span class="gold-text italic">₹${i.price}</span></div>
                    <button onclick="cart.splice(${idx},1); updateCartUI()" class="text-zinc-700 hover:text-white">&times;</button>
                </div>`).join('');
        }

        function nextStep(s) {
            ['1','2','3'].forEach(n => {
                document.getElementById('step'+n+'Content').classList.add('hidden');
                document.getElementById('step'+n+'-dot').className = 'text-zinc-700 border-b border-zinc-800 pb-1';
            });
            document.getElementById('step'+s+'Content').classList.remove('hidden');
            document.getElementById('step'+s+'-dot').className = 'gold-text border-b border-gold pb-1';
        }

        function openCheckout() {
            if(!cart.length) return alert("Your cart is empty");

            document.getElementById('checkoutItemsList').innerHTML = cart.map(i => `
                <div class="flex justify-between py-2 text-[10px] tracking-widest uppercase border-b border-zinc-800">
                    <span>${i.name}</span>
                    <span>₹${i.price}</span>
                </div>`).join('');

            updateCheckoutTotal();
            nextStep(1);
            document.getElementById('checkoutModal').classList.remove('hidden');
        }

        function updateCheckoutTotal(){
            const baseTotal = cart.reduce((s, i) => s + i.price, 0);
            const method = document.querySelector('input[name="pay"]:checked')?.value || "UPI";
            const final = method === "COD" ? baseTotal + COD_FEE : baseTotal;
            document.getElementById('checkoutTotalValue').innerText =
                method === "COD" ? `₹${final} (₹${COD_FEE} COD Fee)` : `₹${final}`;
        }

        function closeCheckout() { document.getElementById('checkoutModal').classList.add('hidden'); }

        function validateShipping() {
            const name = custName.value.trim();
            const phone = custPhone.value.trim();
            const pincode = custPincode.value.trim();
            const locality = custLocality.value.trim();
            const address = custAddress.value.trim();
            const city = custCity.value.trim();
            const state = custState.value;

            if (!name || !phone || !pincode || !locality || !address || !city || !state) {
                alert("⚠️ Please fill all required fields.");
                return false;
            }

            if (!/^[6-9]\d{9}$/.test(phone)) {
                alert("⚠️ Enter valid 10-digit Indian mobile number");
                return false;
            }

            if (!/^\d{6}$/.test(pincode)) {
                alert("⚠️ Enter valid 6-digit pincode");
                return false;
            }

            return true;
        }

        async function submitOrder() {
            const btn = document.getElementById("finalBtn");
            btn.innerText = "Processing...";
            btn.disabled = true;

            if (!validateShipping()) {
                btn.disabled = false;
                btn.innerText = "Place Order";
                return;
            }

            const method = document.querySelector('input[name="pay"]:checked').value;
            let baseTotal = cart.reduce((s, i) => s + i.price, 0);
            const finalTotal = method === "COD" ? baseTotal + COD_FEE : baseTotal;

            const orderData = {
                customer: {
                    name: custName.value,
                    phone: custPhone.value,
                    email: custEmail.value,
                    city: custCity.value,
                    pincode: custPincode.value,
                    address: custAddress.value + ", " + custLocality.value
                },
                order: {
                    items: cart,
                    total: finalTotal,
                    method: method
                },
                time: new Date().toLocaleString()
            };

            try {
                // Save order to Firebase
                await database.ref("orders").push(orderData);
                console.log("✅ Order saved to Firebase");

                // Payment redirect
                if (method === "UPI") {
                    window.location.href = `upi://pay?pa=${MY_UPI_ID}&pn=CLIMAX&am=${finalTotal}&cu=INR`;
                } else {
                    alert("Order placed successfully!");
                    location.reload();
                }

            } catch (err) {
                console.error("❌ Firebase error:", err);
                alert("Something went wrong. Please try again.");
                btn.disabled = false;
                btn.innerText = "Place Order";
            }
        }
    </script>
</body>
</html>
